
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.4, mkdocs-material-7.3.0">
    
    
      
        <title>Changelog - DataTag_helper</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#changelog" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DataTag_helper" class="md-header__button md-logo" aria-label="DataTag_helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DataTag_helper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Changelog
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/allenyllee/DataTag_helper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    DataTag_helper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DataTag_helper" class="md-nav__button md-logo" aria-label="DataTag_helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    DataTag_helper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/allenyllee/DataTag_helper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    DataTag_helper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Changelog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Changelog
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    changelog
  </a>
  
    <nav class="md-nav" aria-label="changelog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#v087" class="md-nav__link">
    v0.8.7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v086" class="md-nav__link">
    v0.8.6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v085" class="md-nav__link">
    v0.8.5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v084" class="md-nav__link">
    v0.8.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v083" class="md-nav__link">
    v0.8.3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v082" class="md-nav__link">
    v0.8.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v081" class="md-nav__link">
    v0.8.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v080" class="md-nav__link">
    v0.8.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v072" class="md-nav__link">
    v0.7.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v071" class="md-nav__link">
    v0.7.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v070" class="md-nav__link">
    v0.7.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v061" class="md-nav__link">
    v0.6.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v06" class="md-nav__link">
    v0.6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v05" class="md-nav__link">
    v0.5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v041" class="md-nav__link">
    v0.4.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v04" class="md-nav__link">
    v0.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v03" class="md-nav__link">
    v0.3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../TROUBLESHOOTING/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Quick Start
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quick Start" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Quick Start
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docs/quick_start/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docs/quick_start/cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docs/quick_start/api/" class="md-nav__link">
        API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docs/quick_start/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/DataTag_helper/" class="md-nav__link">
        Datatag Helper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#changelog" class="md-nav__link">
    changelog
  </a>
  
    <nav class="md-nav" aria-label="changelog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#v087" class="md-nav__link">
    v0.8.7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v086" class="md-nav__link">
    v0.8.6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v085" class="md-nav__link">
    v0.8.5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v084" class="md-nav__link">
    v0.8.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v083" class="md-nav__link">
    v0.8.3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v082" class="md-nav__link">
    v0.8.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v081" class="md-nav__link">
    v0.8.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v080" class="md-nav__link">
    v0.8.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v072" class="md-nav__link">
    v0.7.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v071" class="md-nav__link">
    v0.7.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v070" class="md-nav__link">
    v0.7.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v061" class="md-nav__link">
    v0.6.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v06" class="md-nav__link">
    v0.6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v05" class="md-nav__link">
    v0.5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v041" class="md-nav__link">
    v0.4.1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v04" class="md-nav__link">
    v0.4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#v03" class="md-nav__link">
    v0.3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/allenyllee/DataTag_helper/edit/main/CHANGELOG.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Changelog</h1>
                
                <h2 id="changelog">changelog</h2>
<h3 id="v087">v0.8.7</h3>
<ol>
<li>add .docx support</li>
<li>add .pdf support</li>
<li>Support duplicate content by using title_hash - content_hash as TextID</li>
</ol>
<h3 id="v086">v0.8.6</h3>
<ol>
<li>
<p>exported title in json file use relative path</p>
<p><img alt="" src="../assets/Snipaste_2023-02-09_10-08-42.png" /></p>
</li>
</ol>
<h3 id="v085">v0.8.5</h3>
<ol>
<li>
<p>Set default selection to the first option, and move input dir that contains .txt to the first option.</p>
<p><img alt="" src="../assets/Snipaste_2023-02-08_18-16-48.png" /></p>
</li>
<li>
<p>Rename title to DataTag Helper (標註轉檔小幫手)</p>
</li>
</ol>
<h3 id="v084">v0.8.4</h3>
<ol>
<li>Move SqliteDict into main(), only when using GUI will call it. This is to avoid connecting to the sqlite when test CLI.</li>
</ol>
<h3 id="v083">v0.8.3</h3>
<ol>
<li>Rename to DataTag_helper</li>
</ol>
<h3 id="v082">v0.8.2</h3>
<ol>
<li>
<p>fix "Missing optional dependency 'xlrd'." error, jsut use openpyxl. see: https://github.com/pandas-dev/pandas/issues/38424</p>
</li>
<li>
<p>called monkey patch for gooey gui components only when before entering GUI mode (to avoid non-gui import generate "module not found" error)</p>
</li>
</ol>
<h3 id="v081">v0.8.1</h3>
<p>second labeled json cleaner support input Multiple first labeled file</p>
<p><img alt="choose_multiple_file" src="../assets/choose_multiple_file.gif" /></p>
<h3 id="v080">v0.8.0</h3>
<ol>
<li>
<p>add second_upload function</p>
<p><img alt="Screenshot-of-second_upload" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_DataTag_helper.py_20210503171532.png" /></p>
</li>
<li>
<p>add second labeled json cleaner and converter</p>
<p><img alt="Screenshot-of-second_labeled" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_DataTag_helper.py_20210503171946.png" /></p>
</li>
</ol>
<h3 id="v072">v0.7.2</h3>
<ol>
<li>
<p>add SerialID column in contents tab</p>
<p><img alt="Screenshot-of-SerialID" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20210326162722.png" /></p>
</li>
</ol>
<h3 id="v071">v0.7.1</h3>
<ol>
<li>fix numpy issue</li>
<li>remove xlrd</li>
<li>fix KeyError issue</li>
</ol>
<h3 id="v070">v0.7.0</h3>
<ul>
<li>
<p>新增批次處理txt檔功能</p>
<p><img alt="DataTag_helper_v0.7" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_DataTag_helper.py_20201214223220.png" /></p>
<p>注意：第一層的txt會自動忽略，只會加入第二層以下的txt</p>
<p><img alt="folder_structure" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20201214234918.png" /></p>
</li>
<li>
<p>已標註資料轉換輸出之 excel檔新增多種視圖：</p>
<p>a. 以標註者為單位，一次呈現多位標著者之選項及句子標註結果
<img alt="sent_doc_cmp" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214225512.png" /></p>
<p>b. 以選項為單位，比較多位標註者之結果
<img alt="doc_label_cmp" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214224606.png" /></p>
<p>c. 以句子為單位，比較不同標註者結果
<img alt="sent_label_cmp" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214224717.png" /></p>
<p>d. 以句子編號為單位，比較不同標註者結果
<img alt="sent_label_cmp(wide)" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214224838.png" /></p>
<p>e. 將句子按類別及編號水平展開呈現
<img alt="sentence_label(wide)" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214225322.png" /></p>
<p>f. 將句子按類別水平展開呈現
<img alt="sentence_label" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_libreoffice_20201214225227.png" /></p>
</li>
<li>
<p>未標註 excel 檔轉換成json 時，輸出 TextID mapping</p>
<p>原本的 TextID 是從 excel 中的 Content 全文計算md5 hash得到，
但是因為excel中可能存在非法字元及表情符號，
後來輸出的文章會經過移除非法字元及將表情符號轉成文字的處理，
因此有可能無法還原成原始的全文，造成無法計算得到原始的TextID。
所以另外計算一個TextID 是透過將全文移除非法字元及表情符號後再計算md5，
並且輸出處理後的TextID 與原始TextID 的對應表，
如此當文章同一篇文章經過處理後，因原始 TextID不同而對不上時，
可透過 TextID mapping 比較處理後的TextID，
應該就能對回同一篇文章。</p>
<p><img alt="TextID mapping" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20201214232728.png" /></p>
</li>
</ul>
<h3 id="v061">v0.6.1</h3>
<ul>
<li>
<p>Symptom1: 修復 Windows 下合併檔案出現 openpyxl.utils.exceptions.IllegalCharacterError</p>
<p>Rootcause: The previous generated excel file contains illegal character _x0008_, which is an OOXML escape character[1].</p>
<p>Solution: remove these illegal characters before write to excel<a href="[" title="1条消息)openpyxl.utils.exceptions.IllegalCharacterError 错误原因分析及解决办法_村中少年的专栏-CSDN博客](https://blog.csdn.net/javajiawei/article/details/97147219">2</a>.</p>
</li>
<li>
<p>Symptom2: 修復當 json 檔中有 _xHHHH_ 這類字串(以純文字形式出現)時，輸出的 excel 檔會自動轉換成 _xHHHH_ 的 unicode 字元(僅在 Windows 下發生，在 linux 下會將純文字的底線(underscore, _) 再跳脫一次，轉換成 _x005F_x0008_ [1] 儲存到 excel)</p>
<p>Rootcause: maybe openpyxl bug?</p>
<p>Solution: this is a workaround. when dataframe read from json file by read_json(), look for _xHHHH_ pattern in this dataframe, and unescape it[3] before write to excel.</p>
</li>
<li>
<p>References</p>
<p>[1]:<a href="https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.varianttypes.vtbstring?view=openxml-2.8.1">VTBString Class (DocumentFormat.OpenXml.VariantTypes) | Microsoft Docs</a></p>
<blockquote>
<p>[ISO/IEC 29500-1 1st Edition]</p>
<p><strong>bstr (Basic String)</strong></p>
<p>This element defines a binary basic string variant type, which can store any valid Unicode character. Unicode characters that cannot be directly represented in XML as defined by the XML 1.0 specification, shall be escaped using the Unicode numerical character representation escape character format _xHHHH_, where H represents a hexadecimal character in the character's value. [<em>Example</em>: The Unicode character 8 is not permitted in an XML 1.0 document, so it shall be escaped as _x0008_. <em>end example</em>] To store the literal form of an escape sequence, the initial underscore shall itself be escaped (i.e. stored as _x005F_). [<em>Example</em>: The string literal <em>_x0008_</em> would be stored as <em>_x005F_x0008_</em>. <em>end example</em>]</p>
<p>The possible values for this element are defined by the W3C XML Schema <em>string</em> datatype.</p>
<p>进入python命令行模式，输入如下：</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span>
</code></pre></div>
<p>可得openpyxl模块的路径如下<code>/usr/local/lib/python2.7/site-packages/openpyxl</code>，查看该目录下的cell子目录中的cell.py文件，定位到具体错误代码为：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check string coding, length, and line break character&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="c1"># convert to unicode string</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unicode</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="c1"># string must never be longer than 32,767 characters</span>
    <span class="c1"># truncate if necessary</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[:</span><span class="mi">32767</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">next</span><span class="p">(</span><span class="n">ILLEGAL_CHARACTERS_RE</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">IllegalCharacterError</span>
    <span class="k">return</span> <span class="n">value</span>
</code></pre></div>
<p>其中<code>ILLEGAL_CHARACTERS_RE</code>的定义在文件的开头，如下：</p>
<div class="highlight"><pre><span></span><code><span class="n">ILLEGAL_CHARACTERS_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\000-\010]|[\013-\014]|[\016-\037]&#39;</span><span class="p">)</span>
</code></pre></div>
<p>这里面的非法字符都是八进制，可以到对应的ASCII表中查看，的确都是不常见的不可显示字符，例如退格，响铃等，在此处被定义为excel中的非法字符。\
解决上述错误有两种方法，如下：\
1，既然检测到excel中存在<code>[\000-\010]|[\013-\014]|[\016-\037]</code>这些非法的字符，因此可以将字符串中的非法字符替换掉即可，在重新写入excel即可。如下：</p>
<p><div class="highlight"><pre><span></span><code><span class="n">text</span><span class="o">=</span> <span class="n">ILLEGAL_CHARACTERS_RE</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</code></pre></div>
</p>
</blockquote>
<p>[3]:<a href="https://openpyxl.readthedocs.io/en/stable/_modules/openpyxl/utils/escape.html">openpyxl.utils.escape — openpyxl 3.0.5 documentation</a></p>
<blockquote>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">unescape</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert escaped strings to ASCII: _x000a_ == \n</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">ESCAPED_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;_x([0-9A-Fa-f]</span><span class="si">{4}</span><span class="s2">)_&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sub</span><span class="p">(</span><span class="n">match</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback to unescape chars</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">16</span><span class="p">))</span>

    <span class="k">if</span> <span class="s2">&quot;_x&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ESCAPED_REGEX</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">_sub</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">value</span>
</code></pre></div>
</blockquote>
</li>
</ul>
<h3 id="v06">v0.6</h3>
<ul>
<li>
<p>新增合併檔案功能</p>
<p><img alt="merge file" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_DataTag_helper.py_20200916201632.png" /></p>
</li>
</ul>
<h3 id="v05">v0.5</h3>
<ul>
<li>
<p>新增 train/test 切割功能</p>
<p><img alt="train test split 1" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20200916175230.png" /></p>
<p><img alt="train test split 2" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20200916175730.png" /></p>
</li>
</ul>
<h3 id="v041">v0.4.1</h3>
<ul>
<li>修正當某個欄位漏標時，會產生error而停止輸出
    解法：將漏標的欄位填入nan，方便其他人使用輸出後的檔案做檢查</li>
</ul>
<h3 id="v04">v0.4</h3>
<ol>
<li>
<p>新增原文欄位(移除tag 標籤)</p>
<p><img alt="add Content(remove tag)" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20200910203302.png" /></p>
</li>
<li>
<p>多選選項直接以文字格式用逗號分隔儲存在同一格中</p>
<p><img alt="multiple options" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20200910203330.png" /></p>
</li>
<li>
<p>句子與其標註攤平成兩欄(Sent_Label, Sentence)，沒有句子標註的TextID 則此兩欄留空白</p>
<p><img alt="vertical sent view" src="../assets/Deepin%20%E6%88%AA%E5%9C%96_%E9%81%B8%E5%8F%96%E7%AF%84%E5%9C%8D_20200910203417.png" /></p>
</li>
</ol>
<h3 id="v03">v0.3</h3>
<ul>
<li>
<p>將已標註檔案json 檔下載回來後，轉換成excel檔</p>
<p>轉換後的 excel 內容分三頁：第一頁是contents，包含作者，標題、內文、標註者等；第二頁是document label，也就是類別標註；第三頁是sentence label 句子標註，因為句子有很多類，每類數量不一，我是將之橫向展開成不同欄</p>
<p><img alt="convert json to excel" src="../assets/Snipaste_2020-07-15_18-37-31.png" /></p>
</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../TROUBLESHOOTING/" title="Troubleshooting" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Troubleshooting
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>